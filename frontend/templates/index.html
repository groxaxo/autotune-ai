<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autotune-AI - AI-Powered Pitch Correction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéµ Autotune-AI</h1>
            <p class="subtitle">Professional AI-Powered Audio Pitch Correction</p>
        </header>

        <main>
            <div class="upload-section" id="uploadSection">
                <h2>Upload Audio</h2>
                
                <div class="input-mode-selector">
                    <label class="radio-option">
                        <input type="radio" name="inputMode" value="single" checked>
                        <span>Single Mixed File</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="inputMode" value="separated">
                        <span>Pre-Separated Stems</span>
                    </label>
                </div>

                <form id="uploadForm" enctype="multipart/form-data">
                    <!-- Single file upload -->
                    <div id="singleFileUpload" class="upload-mode">
                        <div class="file-upload-area">
                            <input type="file" id="audioFile" name="audioFile" accept="audio/*">
                            <label for="audioFile" class="file-label">
                                <span class="upload-icon">üìÅ</span>
                                <span class="upload-text">Click to select audio file</span>
                                <span class="upload-hint">WAV, MP3, FLAC supported (max 500MB)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Separated stems upload -->
                    <div id="separatedFilesUpload" class="upload-mode" style="display: none;">
                        <div class="file-upload-area">
                            <input type="file" id="vocalFile" name="vocalFile" accept="audio/*">
                            <label for="vocalFile" class="file-label">
                                <span class="upload-icon">üé§</span>
                                <span class="upload-text">Vocal Track</span>
                            </label>
                        </div>
                        <div class="file-upload-area">
                            <input type="file" id="backingFile" name="backingFile" accept="audio/*">
                            <label for="backingFile" class="file-label">
                                <span class="upload-icon">üéπ</span>
                                <span class="upload-text">Backing Track</span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Processing Settings</h3>
                        
                        <div class="settings-grid">
                            <div class="setting-group">
                                <label for="mode">Mode</label>
                                <select id="mode" name="mode">
                                    <option value="fast" selected>Fast (Heuristic)</option>
                                    <option value="model">Model (ML-based)</option>
                                </select>
                                <small>Fast mode uses musical scale quantization</small>
                            </div>

                            <div class="setting-group">
                                <label for="rootNote">Root Note</label>
                                <select id="rootNote" name="rootNote">
                                    <option value="57">A (A3)</option>
                                    <option value="58">A# (A#3)</option>
                                    <option value="59">B (B3)</option>
                                    <option value="60" selected>C (C4 - Middle C)</option>
                                    <option value="61">C# (C#4)</option>
                                    <option value="62">D (D4)</option>
                                    <option value="63">D# (D#4)</option>
                                    <option value="64">E (E4)</option>
                                    <option value="65">F (F4)</option>
                                    <option value="66">F# (F#4)</option>
                                    <option value="67">G (G4)</option>
                                    <option value="68">G# (G#4)</option>
                                    <option value="69">A (A4 - 440Hz)</option>
                                </select>
                                <small>Key of the song</small>
                            </div>

                            <div class="setting-group">
                                <label for="scale">Scale</label>
                                <select id="scale" name="scale">
                                    <option value="major" selected>Major</option>
                                    <option value="minor">Minor</option>
                                    <option value="chromatic">Chromatic</option>
                                </select>
                                <small>Musical scale for correction</small>
                            </div>

                            <div class="setting-group">
                                <label for="vibratoPreserve">Vibrato Preservation</label>
                                <input type="range" id="vibratoPreserve" name="vibratoPreserve" 
                                       min="0" max="1" step="0.05" value="0.25">
                                <span class="range-value">25%</span>
                                <small>0% = full correction, 100% = natural</small>
                            </div>
                        </div>

                        <details class="advanced-settings">
                            <summary>Advanced Settings</summary>
                            <div class="settings-grid">
                                <div class="setting-group">
                                    <label for="separationModel">Separation Model</label>
                                    <select id="separationModel" name="separationModel">
                                        <option value="htdemucs" selected>HTDemucs</option>
                                        <option value="htdemucs_ft">HTDemucs Fine-tuned</option>
                                        <option value="mdx_extra">MDX Extra</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="pitchMethod">Pitch Detection</label>
                                    <select id="pitchMethod" name="pitchMethod">
                                        <option value="crepe" selected>CREPE (Accurate)</option>
                                        <option value="librosa">Librosa (Fast)</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="vocoderMethod">Vocoder</label>
                                    <select id="vocoderMethod" name="vocoderMethod">
                                        <option value="world" selected>WORLD (High Quality)</option>
                                        <option value="psola">PSOLA (Fast)</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="sampleRate">Sample Rate</label>
                                    <select id="sampleRate" name="sampleRate">
                                        <option value="22050">22050 Hz</option>
                                        <option value="44100" selected>44100 Hz</option>
                                        <option value="48000">48000 Hz</option>
                                    </select>
                                </div>

                                <div class="setting-group checkbox-group">
                                    <label>
                                        <input type="checkbox" id="denoise" name="denoise" checked>
                                        Noise Reduction
                                    </label>
                                </div>

                                <div class="setting-group checkbox-group">
                                    <label>
                                        <input type="checkbox" id="vad" name="vad">
                                        Voice Activity Detection
                                    </label>
                                </div>

                                <div class="setting-group checkbox-group">
                                    <label>
                                        <input type="checkbox" id="align" name="align">
                                        Align Vocal to Backing
                                    </label>
                                </div>
                            </div>
                        </details>
                    </div>

                    <button type="submit" class="btn-primary" id="processBtn">
                        üéµ Process Audio
                    </button>
                </form>
            </div>

            <div class="progress-section" id="progressSection" style="display: none;">
                <h2>Processing...</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p class="progress-text" id="progressText">Initializing...</p>
                <div class="processing-info" id="processingInfo"></div>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <h2>‚úÖ Processing Complete!</h2>
                <div class="result-info">
                    <p>Your audio has been successfully processed.</p>
                    <button class="btn-primary" id="downloadBtn">
                        ‚¨áÔ∏è Download Corrected Audio
                    </button>
                    <button class="btn-secondary" id="newProcessBtn">
                        üîÑ Process Another File
                    </button>
                </div>
            </div>

            <div class="error-section" id="errorSection" style="display: none;">
                <h2>‚ùå Processing Failed</h2>
                <div class="error-info">
                    <p id="errorMessage"></p>
                    <button class="btn-secondary" id="retryBtn">
                        üîÑ Try Again
                    </button>
                </div>
            </div>
        </main>

        <footer>
            <div class="info-cards">
                <div class="info-card">
                    <h3>üéØ Features</h3>
                    <ul>
                        <li>AI-powered pitch detection</li>
                        <li>Musical scale correction</li>
                        <li>Vibrato preservation</li>
                        <li>Professional quality</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h3>‚ö° Performance</h3>
                    <ul>
                        <li>GPU acceleration</li>
                        <li>Fast processing</li>
                        <li>High-quality output</li>
                        <li>Batch processing support</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h3>üìö About</h3>
                    <ul>
                        <li>Open source project</li>
                        <li>Built with PyTorch</li>
                        <li>Uses CREPE & WORLD</li>
                        <li>Professional-grade tools</li>
                    </ul>
                </div>
            </div>
            <p class="copyright">
                &copy; 2024 Autotune-AI | 
                <a href="https://github.com/groxaxo/autotune-ai" target="_blank">GitHub</a>
            </p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
